<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>Workspace Launcher</title></head>
<body>
  <h2>Start Your Dev Workspace</h2>
  <form id="f">
    <div>GitHub Repo URL:<br><input name="repo" required style="width:420px" placeholder="https://github.com/org/repo"></div>
    <div>Your Username:<br><input name="username" required style="width:240px" placeholder="alice"></div>
    <div>Prebuilt Image (optional):<br><input name="prebuilt_image" style="width:420px" placeholder="ghcr.io/org/repo-devcontainer:<sha>"></div>
    <p><button type="submit">Launch</button></p>
  </form>
  <pre id="out" style="background:#f7f7f7;padding:10px"></pre>
  <script>
    document.getElementById('f').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      const r = await fetch('http://127.0.0.1:8000/start-workspace', { method:'POST', body: fd });
      const j = await r.json();
      document.getElementById('out').textContent = JSON.stringify(j, null, 2);
      if (r.ok && j.workspace_url) {
        const a = document.createElement('a');
        a.href = j.workspace_url; a.target = '_blank'; a.textContent = 'Open IDE';
        document.getElementById('out').appendChild(document.createElement('br'));
        document.getElementById('out').appendChild(a);
      }
    });
  </script>
</body>
</html>
